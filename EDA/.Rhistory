df <- read.csv("../data/phoneme.csv", header = TRUE)
summary(df)
df <- read.csv("../data/phoneme.csv", header = TRUE)
summary(df)
df$id <- NULL                                  # eliminar columna id
df$Class <- factor(df$Class)                   # convertir a categórica
prop.table(table(df$Class)) * 100              # % por categoría
summary(df)
df <- read.csv("../data/phoneme.csv", header = TRUE)
summary(df)
df$id <- NULL                                  # eliminar columna id
df$Class <- factor(df$Class)                   # convertir a categórica
prop.table(table(df$Class)) * 100              # % por categoría
summary(df)
df <- read.csv("../data/phoneme.csv", header = TRUE)
summary(df)
df$id <- NULL                                  # eliminar columna id
df$Class <- factor(df$Class, levels = c(1,2), labels = c("nasal","oral"))
prop.table(table(df$Class)) * 100              # % por categoría
summary(df)
df <- read.csv("../data/phoneme.csv", header = TRUE)
df$id <- NULL                                  # delete id column
df$Class <- factor(df$Class, levels = c(1,2), labels = c("nasal","oral"))
prop.table(table(df$Class)) * 100              # % for each category
summary(df)
summary(df[,1])
hist(df$age, breaks = 40, freq = F);curve(dnorm(x, mean(df$age), sd(df$age)), add = T)
summary(df[,1])
hist(df$V1, breaks = 40, freq = F);curve(dnorm(x, mean(df$V1), sd(df$V1)), add = T)
Boxplot(df$V1)
library(car)
summary(df[,1])
hist(df$V1, breaks = 40, freq = F);curve(dnorm(x, mean(df$V1), sd(df$V1)), add = T)
Boxplot(df$V1)
length(Boxplot(df$V1, id=list(n=Inf)))
varsumm1<-summary (df[,1])
iqr1 <- varsumm1[5]-varsumm1[2]
umout1 <- varsumm1[5]+1.5*iqr1; umout1
usout1 <- varsumm1[5]+3*iqr1; usout1
lmout1 <- varsumm1[2]-1.5*iqr1; lmout1
lsout1 <- varsumm1[2]-3*iqr1; lsout1
mout1<- which((df[,1]<lmout1)|(df[,1]>umout1));length(mout1) #487 mout
sout1 <-which((df[,1]<lsout1)|(df[,1]>usout1));length(sout1) #3 sout
summary(df[,2])
hist(df$V2, breaks = 40, freq = F);curve(dnorm(x, mean(df$V2), sd(df$V2)), add = T)
Boxplot(df$V2)
length(Boxplot(df$V2, id=list(n=Inf)))
varsumm2<-summary (df[,2])
iqr2 <- varsumm2[5]-varsumm2[2]
umout2 <- varsumm2[5]+1.5*iqr2; umout2
usout2 <- varsumm2[5]+3*iqr2; usout2
lmout2 <- varsumm2[2]-1.5*iqr2; lmout2
lsout2 <- varsumm2[2]-3*iqr2; lsout2
mout2<- which((df[,2]<lmout2)|(df[,2]>umout2));length(mout2) #491 mout
sout2 <-which((df[,2]<lsout2)|(df[,2]>usout2));length(sout2) #23 sout
Boxplot(df$V2)
summary(df[,3])
hist(df$V3, breaks = 40, freq = F);curve(dnorm(x, mean(df$V3), sd(df$V3)), add = T)
Boxplot(df$V3)
length(Boxplot(df$V3, id=list(n=Inf)))
varsumm3<-summary (df[,3])
iqr3 <- varsumm3[5]-varsumm3[2]
umout3 <- varsumm3[5]+1.5*iqr3; umout3
usout3 <- varsumm3[5]+3*iqr3; usout3
lmout3 <- varsumm3[2]-1.5*iqr3; lmout3
lsout3 <- varsumm3[2]-3*iqr3; lsout3
mout3<- which((df[,2]<lmout3)|(df[,3]>umout3));length(mout3) #491 mout
sout3 <-which((df[,2]<lsout3)|(df[,3]>usout3));length(sout3) #23 sout
varsumm3<-summary (df[,3])
Boxplot(df$V3)
length(Boxplot(df$V3, id=list(n=Inf)))
varsumm3<-summary (df[,3])
iqr3 <- varsumm3[5]-varsumm3[2]
umout3 <- varsumm3[5]+1.5*iqr3; umout3
usout3 <- varsumm3[5]+3*iqr3; usout3
lmout3 <- varsumm3[2]-1.5*iqr3; lmout3
lsout3 <- varsumm3[2]-3*iqr3; lsout3
mout3<- which((df[,3]<lmout3)|(df[,3]>umout3));length(mout3) #491 mout
sout3 <-which((df[,3]<lsout3)|(df[,3]>usout3));length(sout3) #23 sout
summary(df[,4])
hist(df$V4, breaks = 40, freq = F);curve(dnorm(x, mean(df$V4), sd(df$V4)), add = T)
Boxplot(df$V4)
length(Boxplot(df$V4, id=list(n=Inf)))
varsumm4<-summary (df[,4])
iqr4 <- varsumm4[5]-varsumm4[2]
umout4 <- varsumm4[5]+1.5*iqr4; umout4
usout4 <- varsumm4[5]+3*iqr4; usout4
lmout4 <- varsumm4[2]-1.5*iqr4; lmout4
lsout4 <- varsumm4[2]-3*iqr4; lsout4
mout4 <- which((df[,4]<lmout4)|(df[,4]>umout4));length(mout4) #491 mout
sout4 <-which((df[,4]<lsout4)|(df[,4]>usout4));length(sout4) #23 sout
Boxplot(df$V4)
summary(df[,5])
hist(df$V5, breaks = 40, freq = F);curve(dnorm(x, mean(df$V5), sd(df$V5)), add = T)
Boxplot(df$V5)
length(Boxplot(df$V5, id=list(n=Inf)))
varsumm5<-summary (df[,5])
iqr5 <- varsumm5[5]-varsumm5[2]
umout5 <- varsumm5[5]+1.5*iqr5; umout5
usout5 <- varsumm5[5]+3*iqr5; usout5
lmout5 <- varsumm5[2]-1.5*iqr5; lmout5
lsout5 <- varsumm5[2]-3*iqr5; lsout5
mout5 <- which((df[,5]<lmout5)|(df[,5]>umout5));length(mout5) #491 mout
sout5 <-which((df[,5]<lsout5)|(df[,5]>usout5));length(sout5) #23 sout
hist(df$V5, breaks = 40, freq = F);curve(dnorm(x, mean(df$V5), sd(df$V5)), add = T)
Boxplot(df$V5)
summary(df[,6])
str(df$Class)
plot(df$Class)
Check if the numerical features are correlated somehow
library(corrplot)
num_vars <- c("V1", "V2", "V3", "V4", "V5")
cor_matrix <- cor(df[, num_vars], use = "complete.obs")
par(mar = c(1, 1, 3, 2))
corrplot(
cor_matrix,
method = "color",
tl.cex = 0.9,
tl.col = "black",
title = "Correlation matrix of numerical variables",
mar = c(0, 0, 2, 0),
addgrid.col = "grey90",
cl.pos = "r"
)
summary(df[,6])
str(df$Class)
plot(df$Class)
barplot(table(df$Class), col=c("steelblue","tomato"))
summary(df[,6])
str(df$Class)
barplot(table(df$Class), col=c("steelblue","tomato"))
library(ggplot2)
for (v in c("V1","V2","V3","V4","V5")) {
p <- ggplot(df, aes_string(x=v, fill="Class")) +
geom_density(alpha = 0.4) +
ggtitle(paste("Density of", v, "by class"))
print(p)
}
for (v in c("V1","V2","V3","V4","V5")) {
boxplot(df[[v]] ~ df$Class,
main = paste("Boxplot of", v, "by class"),
xlab = "Class", ylab = v,
col = c("steelblue","tomato"))
}
library(e1071)
skewness_values  <- sapply(df[,1:5], skewness)
kurtosis_values <- sapply(df[,1:5], kurtosis)
skewness_values
kurtosis_values
pairs(df[,1:5], col = df$Class,
main = "Scatterplot matrix of numerical variables")
sapply(df[,1:5], range)
library(e1071)
skewness_values  <- sapply(df[,1:5], skewness)
kurtosis_values <- sapply(df[,1:5], kurtosis)
skewness_values
kurtosis_values
df <- read.csv("../data/phoneme.csv", header = TRUE)
df_no_dupl <- distinct(df) #there are no duplicates in our dataset
library(car)
library(dplyr)
df <- read.csv("../data/phoneme.csv", header = TRUE)
df_no_dupl <- distinct(df) #there are no duplicates in our dataset
rm(df_no_dupl)
df <- read.csv("../data/phoneme.csv", header = TRUE)
df_no_dupl <- distinct(df) #there are no duplicates in our dataset
rm(df_no_dupl)
df$id <- NULL                                  # delete id column
df$Class <- factor(df$Class, levels = c(1,2), labels = c("nasal","oral"))
prop.table(table(df$Class)) * 100              # % for each category
summary(df)
library(car)
library(dplyr)
library(FactoMineR)
library(factoextra)
# ============================================================
# ---  Exploratory PCA  ---
# ============================================================
X_pca <- as.data.frame(X)
# Select only numerical features (V1 to V5)
X_pca <- df[, 1:5]
# PCA with centering and scaling
pca <- prcomp(X_pca, center = TRUE, scale. = TRUE)
# Explained variance
summary(pca)
# Scree plot
fviz_eig(pca, addlabels = TRUE, barfill = "steelblue", barcolor = "steelblue") +
theme_minimal() +
labs(title = "Explained variance by principal components")
# Variable contributions
fviz_pca_var(pca,
col.var = "contrib",
gradient.cols = c("lightblue", "steelblue", "darkblue"),
repel = TRUE) +
theme_minimal() +
labs(title = "PCA - Variable contributions")
library(car)
library(dplyr)
library(FactoMineR)
library(factoextra)
df <- read.csv("../data/phoneme.csv", header = TRUE)
df_no_dupl <- distinct(df) #there are no duplicates in our dataset
rm(df_no_dupl)
df$id <- NULL                                  # delete id column
df$Class <- factor(df$Class, levels = c(1,2), labels = c("nasal","oral"))
prop.table(table(df$Class)) * 100              # % for each category
summary(df)
summary(df[,1])
hist(df$V1, breaks = 40, freq = F);curve(dnorm(x, mean(df$V1), sd(df$V1)), add = T)
Boxplot(df$V1)
length(Boxplot(df$V1, id=list(n=Inf)))
varsumm1<-summary (df[,1])
iqr1 <- varsumm1[5]-varsumm1[2]
umout1 <- varsumm1[5]+1.5*iqr1; umout1
usout1 <- varsumm1[5]+3*iqr1; usout1
lmout1 <- varsumm1[2]-1.5*iqr1; lmout1
lsout1 <- varsumm1[2]-3*iqr1; lsout1
mout1<- which((df[,1]<lmout1)|(df[,1]>umout1));length(mout1) #491 mout
sout1 <-which((df[,1]<lsout1)|(df[,1]>usout1));length(sout1) #23 sout
summary(df[,2])
hist(df$V2, breaks = 40, freq = F);curve(dnorm(x, mean(df$V2), sd(df$V2)), add = T)
Boxplot(df$V2)
length(Boxplot(df$V2, id=list(n=Inf)))
varsumm2<-summary (df[,2])
iqr2 <- varsumm2[5]-varsumm2[2]
umout2 <- varsumm2[5]+1.5*iqr2; umout2
usout2 <- varsumm2[5]+3*iqr2; usout2
lmout2 <- varsumm2[2]-1.5*iqr2; lmout2
lsout2 <- varsumm2[2]-3*iqr2; lsout2
mout2<- which((df[,2]<lmout2)|(df[,2]>umout2));length(mout2) #491 mout
sout2 <-which((df[,2]<lsout2)|(df[,2]>usout2));length(sout2) #23 sout
summary(df[,3])
hist(df$V3, breaks = 40, freq = F);curve(dnorm(x, mean(df$V3), sd(df$V3)), add = T)
Boxplot(df$V3)
length(Boxplot(df$V3, id=list(n=Inf)))
varsumm3<-summary (df[,3])
iqr3 <- varsumm3[5]-varsumm3[2]
umout3 <- varsumm3[5]+1.5*iqr3; umout3
usout3 <- varsumm3[5]+3*iqr3; usout3
lmout3 <- varsumm3[2]-1.5*iqr3; lmout3
lsout3 <- varsumm3[2]-3*iqr3; lsout3
mout3<- which((df[,3]<lmout3)|(df[,3]>umout3));length(mout3) #491 mout
sout3 <-which((df[,3]<lsout3)|(df[,3]>usout3));length(sout3) #23 sout
summary(df[,4])
hist(df$V4, breaks = 40, freq = F);curve(dnorm(x, mean(df$V4), sd(df$V4)), add = T)
Boxplot(df$V4)
length(Boxplot(df$V4, id=list(n=Inf)))
varsumm4<-summary (df[,4])
iqr4 <- varsumm4[5]-varsumm4[2]
umout4 <- varsumm4[5]+1.5*iqr4; umout4
usout4 <- varsumm4[5]+3*iqr4; usout4
lmout4 <- varsumm4[2]-1.5*iqr4; lmout4
lsout4 <- varsumm4[2]-3*iqr4; lsout4
mout4 <- which((df[,4]<lmout4)|(df[,4]>umout4));length(mout4) #491 mout
sout4 <-which((df[,4]<lsout4)|(df[,4]>usout4));length(sout4) #23 sout
summary(df[,5])
hist(df$V5, breaks = 40, freq = F);curve(dnorm(x, mean(df$V5), sd(df$V5)), add = T)
Boxplot(df$V5)
length(Boxplot(df$V5, id=list(n=Inf)))
varsumm5<-summary (df[,5])
iqr5 <- varsumm5[5]-varsumm5[2]
umout5 <- varsumm5[5]+1.5*iqr5; umout5
usout5 <- varsumm5[5]+3*iqr5; usout5
lmout5 <- varsumm5[2]-1.5*iqr5; lmout5
lsout5 <- varsumm5[2]-3*iqr5; lsout5
mout5 <- which((df[,5]<lmout5)|(df[,5]>umout5));length(mout5) #491 mout
sout5 <-which((df[,5]<lsout5)|(df[,5]>usout5));length(sout5) #23 sout
summary(df[,6])
str(df$Class)
barplot(table(df$Class), col=c("steelblue","tomato"))
library(corrplot)
num_vars <- c("V1", "V2", "V3", "V4", "V5")
cor_matrix <- cor(df[, num_vars], use = "complete.obs")
par(mar = c(1, 1, 3, 2))
corrplot(
cor_matrix,
method = "color",
tl.cex = 0.9,
tl.col = "black",
title = "Correlation matrix of numerical variables",
mar = c(0, 0, 2, 0),
addgrid.col = "grey90",
cl.pos = "r"
)
library(e1071)
skewness_values  <- sapply(df[,1:5], skewness)
kurtosis_values <- sapply(df[,1:5], kurtosis)
skewness_values
kurtosis_values
sapply(df[,1:5], range)
# Select only numerical features (V1 to V5)
X_pca <- df[, 1:5]
# PCA with centering and scaling
pca <- prcomp(X_pca, center = TRUE, scale. = TRUE)
# Explained variance
summary(pca)
# Scree plot
fviz_eig(pca, addlabels = TRUE, barfill = "steelblue", barcolor = "steelblue") +
theme_minimal() +
labs(title = "Explained variance by principal components")
# Variable contributions
fviz_pca_var(pca,
col.var = "contrib",
gradient.cols = c("lightblue", "steelblue", "darkblue"),
repel = TRUE) +
theme_minimal() +
labs(title = "PCA - Variable contributions")
zscore_fit <- function(df_num) {
list(
means = sapply(df_num, mean, na.rm = TRUE),
sds   = sapply(df_num, sd,   na.rm = TRUE)
)
}
zscore_transform <- function(df_num, fit) {
scale(df_num, center = fit$means, scale = fit$sds) |> as.data.frame()
}
preprocess_split <- function(df, train_idx, test_idx) {
# 1) Explicit split
train <- df[train_idx, , drop = FALSE]
test  <- df[test_idx,  , drop = FALSE]
# 2) Identify numeric predictors (V1–V5)
num_vars <- sapply(train, is.numeric)
# 3) Fit Z-score scaling on TRAIN
zfit <- zscore_fit(train[, num_vars, drop = FALSE])
# 4) Apply scaling
train_scaled <- zscore_transform(train[, num_vars, drop = FALSE], zfit)
test_scaled  <- zscore_transform(test[,  num_vars, drop = FALSE], zfit)
# Replace numeric columns with scaled versions
train[, num_vars] <- train_scaled
test[,  num_vars] <- test_scaled
# 5) Build X/y objects
X_train <- subset(train, select = -Class)
y_train <- train$Class
X_test <- subset(test, select = -Class)
y_test <- test$Class
list(
X_train = X_train,
y_train = y_train,
X_test  = X_test,
y_test  = y_test,
params  = list(zscore = zfit)
)
}
library(caret)
set.seed(42)
K <- 5
folds_outer <- createFolds(df$Class, k = K, returnTrain = TRUE)
train_folds <- vector("list", K)
test_folds  <- vector("list", K)
for (k in seq_len(K)) {
train_idx <- folds_outer[[k]]
test_idx  <- setdiff(seq_len(nrow(df)), train_idx)
prep <- preprocess_split(df, train_idx, test_idx)
train_folds[[k]] <- list(
X_train = prep$X_train,
y_train = prep$y_train,
params  = prep$params
)
test_folds[[k]] <- list(
X_test = prep$X_test,
y_test = prep$y_test
)
assign(paste0("train_fold", k), train_folds[[k]])
assign(paste0("test_fold",  k), test_folds[[k]])
}
cat("Preprocessing completed for all folds.\n")
library(car)
library(dplyr)
library(FactoMineR)
library(factoextra)
df <- read.csv("../data/phoneme.csv", header = TRUE)
df_no_dupl <- distinct(df) #there are no duplicates in our dataset
rm(df_no_dupl)
df$id <- NULL                                  # delete id column
df$Class <- factor(df$Class, levels = c(1,2), labels = c("nasal","oral"))
prop.table(table(df$Class)) * 100              # % for each category
summary(df)
summary(df[,1])
hist(df$V1, breaks = 40, freq = F);curve(dnorm(x, mean(df$V1), sd(df$V1)), add = T)
Boxplot(df$V1)
length(Boxplot(df$V1, id=list(n=Inf)))
varsumm1<-summary (df[,1])
iqr1 <- varsumm1[5]-varsumm1[2]
umout1 <- varsumm1[5]+1.5*iqr1; umout1
usout1 <- varsumm1[5]+3*iqr1; usout1
lmout1 <- varsumm1[2]-1.5*iqr1; lmout1
lsout1 <- varsumm1[2]-3*iqr1; lsout1
mout1<- which((df[,1]<lmout1)|(df[,1]>umout1));length(mout1) #491 mout
sout1 <-which((df[,1]<lsout1)|(df[,1]>usout1));length(sout1) #23 sout
summary(df[,2])
hist(df$V2, breaks = 40, freq = F);curve(dnorm(x, mean(df$V2), sd(df$V2)), add = T)
Boxplot(df$V2)
length(Boxplot(df$V2, id=list(n=Inf)))
varsumm2<-summary (df[,2])
iqr2 <- varsumm2[5]-varsumm2[2]
umout2 <- varsumm2[5]+1.5*iqr2; umout2
usout2 <- varsumm2[5]+3*iqr2; usout2
lmout2 <- varsumm2[2]-1.5*iqr2; lmout2
lsout2 <- varsumm2[2]-3*iqr2; lsout2
mout2<- which((df[,2]<lmout2)|(df[,2]>umout2));length(mout2) #491 mout
sout2 <-which((df[,2]<lsout2)|(df[,2]>usout2));length(sout2) #23 sout
summary(df[,3])
hist(df$V3, breaks = 40, freq = F);curve(dnorm(x, mean(df$V3), sd(df$V3)), add = T)
Boxplot(df$V3)
length(Boxplot(df$V3, id=list(n=Inf)))
varsumm3<-summary (df[,3])
iqr3 <- varsumm3[5]-varsumm3[2]
umout3 <- varsumm3[5]+1.5*iqr3; umout3
usout3 <- varsumm3[5]+3*iqr3; usout3
lmout3 <- varsumm3[2]-1.5*iqr3; lmout3
lsout3 <- varsumm3[2]-3*iqr3; lsout3
mout3<- which((df[,3]<lmout3)|(df[,3]>umout3));length(mout3) #491 mout
sout3 <-which((df[,3]<lsout3)|(df[,3]>usout3));length(sout3) #23 sout
summary(df[,4])
hist(df$V4, breaks = 40, freq = F);curve(dnorm(x, mean(df$V4), sd(df$V4)), add = T)
Boxplot(df$V4)
length(Boxplot(df$V4, id=list(n=Inf)))
varsumm4<-summary (df[,4])
iqr4 <- varsumm4[5]-varsumm4[2]
umout4 <- varsumm4[5]+1.5*iqr4; umout4
usout4 <- varsumm4[5]+3*iqr4; usout4
lmout4 <- varsumm4[2]-1.5*iqr4; lmout4
lsout4 <- varsumm4[2]-3*iqr4; lsout4
mout4 <- which((df[,4]<lmout4)|(df[,4]>umout4));length(mout4) #491 mout
sout4 <-which((df[,4]<lsout4)|(df[,4]>usout4));length(sout4) #23 sout
summary(df[,5])
hist(df$V5, breaks = 40, freq = F);curve(dnorm(x, mean(df$V5), sd(df$V5)), add = T)
Boxplot(df$V5)
length(Boxplot(df$V5, id=list(n=Inf)))
varsumm5<-summary (df[,5])
iqr5 <- varsumm5[5]-varsumm5[2]
umout5 <- varsumm5[5]+1.5*iqr5; umout5
usout5 <- varsumm5[5]+3*iqr5; usout5
lmout5 <- varsumm5[2]-1.5*iqr5; lmout5
lsout5 <- varsumm5[2]-3*iqr5; lsout5
mout5 <- which((df[,5]<lmout5)|(df[,5]>umout5));length(mout5) #491 mout
sout5 <-which((df[,5]<lsout5)|(df[,5]>usout5));length(sout5) #23 sout
summary(df[,6])
str(df$Class)
barplot(table(df$Class), col=c("steelblue","tomato"))
library(corrplot)
num_vars <- c("V1", "V2", "V3", "V4", "V5")
cor_matrix <- cor(df[, num_vars], use = "complete.obs")
par(mar = c(1, 1, 3, 2))
corrplot(
cor_matrix,
method = "color",
tl.cex = 0.9,
tl.col = "black",
title = "Correlation matrix of numerical variables",
mar = c(0, 0, 2, 0),
addgrid.col = "grey90",
cl.pos = "r"
)
library(e1071)
skewness_values  <- sapply(df[,1:5], skewness)
kurtosis_values <- sapply(df[,1:5], kurtosis)
skewness_values
kurtosis_values
sapply(df[,1:5], range)
# Select only numerical features (V1 to V5)
X_pca <- df[, 1:5]
# PCA with centering and scaling
pca <- prcomp(X_pca, center = TRUE, scale. = TRUE)
# Explained variance
summary(pca)
# Scree plot
fviz_eig(pca, addlabels = TRUE, barfill = "steelblue", barcolor = "steelblue") +
theme_minimal() +
labs(title = "Explained variance by principal components")
# Variable contributions
fviz_pca_var(pca,
col.var = "contrib",
gradient.cols = c("lightblue", "steelblue", "darkblue"),
repel = TRUE) +
theme_minimal() +
labs(title = "PCA - Variable contributions")
write.csv(df_clean, "../data/phoneme_python.csv", row.names = FALSE)
write.csv(df, "../data/phoneme_python.csv", row.names = FALSE)
